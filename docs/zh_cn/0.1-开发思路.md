# 开发思路

MaaFramework 支持通过 Json 低代码编程（Pipeline Json）；同时也提供了 C++, [Python](https://pypi.org/project/MaaFw/) 绑定以供开发者更灵活的操作；还可以将低代码作为一种 “封装” 进行调用。下面介绍几种常用的集成方式：

## 完全依赖 Json 低代码编程（使用 MaaPiCli.exe）

简单快捷，但不够灵活，推荐 MaaFramework 初学者及编程小白使用。  
我们为此方式提供了 [🎞️视频教程](https://www.bilibili.com/video/BV1yr421E7MW) 和 [⭐项目模板](https://github.com/MaaXYZ/MaaPracticeBoilerplate)。以下是一个例子：

```jsonc
{
    "识别并点击开始按钮": {
        "recognition": "OCR",           // 文字识别
        "expected": "开始",             // 要识别的字
        "action": "Click",              // 动作：点击
        "next": [
            "识别并点击确定图标",
        ]
    },
    "识别并点击确认图标": {
        "recognition": "TemplateMatch", // 图片模板匹配
        "template": "确认.png",         // 图片文件名
        "action": "Click"
    }
}
```

## 使用 Json 低代码编程，但对复杂任务使用自定义逻辑

通过接口启动 CLI，同时注册部分自定义任务。该方法可从 1 中无缝切换。以下是一个例子：

```jsonc
{
    "识别并点击确认图标": {
        "next": [
            "我的自定义任务"
        ]
    },
    "我的自定义任务": {
        "recognition": "Custom",
        "custom_recognition": "MyReco",
        "action": "Custom",
        "custom_action": "MyAct"
    }
}
```

```python
# 此处为伪代码，仅供参考思路，无法直接运行
def main():
    my_act = MyAction()
    my_reco = MyRecognizer()
    maafw.Toolkit.register_custom_recognition("MyReco", my_reco)
    maafw.Toolkit.register_custom_action("MyAct", my_act)
    maafw.Toolkit.run_pi_cli()  # 这一行相当于启动 MaaPiCli.exe

class MyReco(CustomRecognizer):
    def analyze(context, ...):
        image = context.controller().cached_image()

class MyAction(CustomAction):
    def run(context, ...):
        context.controller().post_click(100, 10).wait()
```

## 自行编写代码。可以将低代码作为一种“封装”进行调用，亦可注册自定义回调使用

```python
# 此处为伪代码，仅供参考思路，无法直接运行
# "识别结算画面", "点击确认" 等均为 Json 中的逻辑
def main():
    detail = tasker.post_recognition("识别结算画面").wait().get()

    if detail.text == "战斗失败":
        tasker.controller().post_click(100, 100).wait()

    else detail.text == "战斗完成":
        image = tasker.controller().cached_image()
        save_to_file(image)

        my_act = MyAction()
        tasker.resource().register_custom_action("MyAction", my_act)
        tasker.post_pipeline("识别并点击确认图标").wait()

```
